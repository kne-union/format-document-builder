(self.webpackChunk_kne_components_format_document_builder=self.webpackChunk_kne_components_format_document_builder||[]).push([[830],{71830:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>I});var r=n(94922),o=n.n(r),i=n(74946),l=n(9211),a=n.n(l),s=n(87832),c=n.n(s),u=n(54613),d=n.n(u),p=n(78678),g=n(67823),m=n(28833),f=n(15032),h=n(79111),v=n(54159),b=n.n(v);const{useContext:y,Provider:x}=(0,i.createContext)(),E=()=>{const{setRenderHtml:e,templateContent:t,initFormData:n,data:i,options:l,deleteFields:c}=y(),u=(0,s.useFormContext)(),m=Object.assign({},n,null==u?void 0:u.formData),f=(0,r.useRef)(null),h=(0,r.useMemo)((()=>d()(t)),[t])({data:a()(m,((e,t,r)=>{"function"===typeof i[r].render?e[r]=i[r].render(t):e[r]=t,(0,g.isEmpty)(e[r])&&(e[r]=n[r])}),{}),isDeletedField:e=>c.indexOf(e)>-1||null===m[e],options:l}),v=(0,p.A)(e);return(0,r.useEffect)((()=>{new MutationObserver((()=>{v(f.current.innerHTML)})).observe(f.current,{childList:!0,subtree:!0})}),[v]),o().createElement("div",{dangerouslySetInnerHTML:{__html:h},ref:f})};function _(){return _=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_.apply(null,arguments)}function w(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}const R=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","font-variant","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing","word-break","white-space"],A={};let C;function j(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;C||(C=document.createElement("textarea"),C.setAttribute("tab-index","-1"),C.setAttribute("aria-hidden","true"),document.body.appendChild(C)),e.getAttribute("wrap")?C.setAttribute("wrap",e.getAttribute("wrap")):C.removeAttribute("wrap");const{paddingSize:o,borderSize:i,boxSizing:l,sizingStyle:a}=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e.getAttribute("id")||e.getAttribute("data-reactid")||e.getAttribute("name");if(t&&A[n])return A[n];const r=window.getComputedStyle(e),o=r.getPropertyValue("box-sizing")||r.getPropertyValue("-moz-box-sizing")||r.getPropertyValue("-webkit-box-sizing"),i=parseFloat(r.getPropertyValue("padding-bottom"))+parseFloat(r.getPropertyValue("padding-top")),l=parseFloat(r.getPropertyValue("border-bottom-width"))+parseFloat(r.getPropertyValue("border-top-width")),a={sizingStyle:R.map((e=>`${e}:${r.getPropertyValue(e)}`)).join(";"),paddingSize:i,borderSize:l,boxSizing:o};return t&&n&&(A[n]=a),a}(e,t);let s,c,u;C.setAttribute("style",`${a};\n  min-height:0 !important;\n  max-height:none !important;\n  height:0 !important;\n  visibility:hidden !important;\n  overflow:hidden !important;\n  position:absolute !important;\n  z-index:-1000 !important;\n  top:0 !important;\n  right:0 !important;\n  pointer-events: none !important;\n`),C.value=e.value||e.placeholder||"";let d=C.scrollHeight;if("border-box"===l?d+=i:"content-box"===l&&(d-=o),null!==n||null!==r){C.value=" ";const e=C.scrollHeight-o;null!==n&&(s=e*n,"border-box"===l&&(s=s+o+i),d=Math.max(s,d)),null!==r&&(c=e*r,"border-box"===l&&(c=c+o+i),u=d>c?"":"hidden",d=Math.min(c,d))}const p={height:d,overflowY:u,resize:"none"};return s&&(p.minHeight=s),c&&(p.maxHeight=c),p}const k=["onChange","triggerValidate","value","style","isActive","className"],S=e=>t=>{const{useField:n}=s.hooks,r=n(t);return o().createElement(e,Object.assign({},t,r))},O={Input:S((e=>{let{onChange:t,triggerValidate:n,value:i,isActive:l,style:a,className:s}=e;(0,r.useEffect)((()=>{l&&c.current.focus()}),[l]);const c=(0,r.useRef)();return o().createElement("input",{ref:c,style:Object.assign({},a,{border:"none",outline:"none",display:"block"}),className:b()(s,"react-form__field-component"),value:i||"",onChange:t,onBlur:n})})),TextArea:S((e=>{let{onChange:t,triggerValidate:n,value:i,style:l,isActive:a,className:s}=e;w(e,k);const[c,u]=(0,r.useState)({}),d=(0,r.useRef)();return(0,r.useEffect)((()=>{const e=()=>{a&&u(j(d.current))};e();const t=new MutationObserver(e);return t.observe(d.current,{subtree:!0,childList:!0}),()=>{t.disconnect()}}),[a]),(0,r.useEffect)((()=>{a&&d.current.focus()}),[a]),o().createElement("textarea",{ref:d,style:Object.assign({},l,{border:"none",outline:"none",display:"block",resize:"none"},c),className:b()(s,"react-form__field-component"),value:i||"",onChange:e=>{t(e.target.value)},onBlur:n})}))};var z="_Tn8Z5",P="_GouxO",F="_hM9TE",N="_Y-KpS",H="_Aab98",L="_srojx";const $=["isArray","type","typeProps","width","height","className","canDelete","deleteButton","canEdit","editButton"],B=()=>{const{data:e,getRootElement:t,setDeleteFields:n,getRenderElement:i,fields:l,deleteFields:c,rootElementId:u}=y(),d=Object.assign({},s.fields,O,l),{openApi:p}=(0,s.useFormContext)(),[g,v]=(0,r.useState)(null),x=(e=>{let{getRootElement:t,tags:n,getRenderElement:o,onSelected:i,onCancel:l}=e;const a=(0,r.useRef)(n);a.current=n;const s=(0,r.useRef)(null);return(0,r.useEffect)((()=>{const e=s.current,n=n=>{let{clientX:r,clientY:s,target:c}=n;const u=o(),d=t();e.style["pointer-events"]="none",u.style["pointer-events"]="all";const p=document.elementFromPoint(r,s);u.style["pointer-events"]="none",e.style["pointer-events"]="all";const{currentTag:g,currentIndex:m,currentName:f}=(()=>{let e,t,n;for(let r of Object.keys(a.current)){const o=a.current[r],i=[].findIndex.call(d.querySelectorAll(`.${o}`),(e=>e.contains(p)));if(i>-1){e=o,t=i,n=r;break}}return{currentTag:e,currentIndex:t,currentName:n}})();if(!c.classList.contains("event-element"))return;if(!g)return void(l&&l());const h=d.querySelectorAll(`.${g}`)[m],v=h.getBoundingClientRect(),b=d.getBoundingClientRect(),y=window.getComputedStyle(p,null),x=window.getComputedStyle(h,null);"0px"!==y["font-size"]&&"0px"!==y["line-height"]?i&&i({location:{width:h.clientWidth,height:h.clientHeight,left:v.left-b.left,top:v.top-b.top},style:{fontSize:y["font-size"],fontWeight:y["font-weight"],textAlign:y["text-align"],lineHeight:y["line-height"],padding:x.padding},currentElement:p,currentTag:g,currentIndex:m,currentName:f}):l&&l()},r=e=>{!e.target&&t().contains(e.target)&&l&&l()};return e.addEventListener("click",n,!1),document.body.addEventListener("click",r,!0),window.addEventListener("resize",r),()=>{e.removeEventListener("click",n,!1),document.body.removeEventListener("click",r,!0),window.removeEventListener("resize",r)}}),[]),s})({getRootElement:t,getRenderElement:i,tags:a()(e,((e,t,n)=>{!1!==t.canEdit&&(e[n]=t.className)}),{}),onSelected:e=>{v(e)},onCancel:()=>{v(null)}});return o().createElement("div",{className:b()("event-element",F),ref:x},Object.keys(e).filter((e=>-1===c.indexOf(e))).map((r=>{const l=e[r],{isArray:a,type:c,typeProps:y,width:E,height:R,className:A,canDelete:C,deleteButton:j,canEdit:k=!0,editButton:S}=l,O=w(l,$),z=d[c];if(!z)return null;const P=e=>{const l=g&&g.currentName===r&&g.currentIndex===e&&k,s=(()=>{const n=i().querySelectorAll(`.${A}`)[e];if(!n)return null;const r=t();if(!r)return null;const{left:o,top:l}=null==r?void 0:r.getBoundingClientRect(),{left:a,top:s}=n.getBoundingClientRect();return{x:a-o+n.clientWidth,y:s-l+n.clientHeight/2,left:a,top:s,element:n,width:n.clientWidth,height:n.clientHeight}})(),c=e=>{var t;e.stopPropagation();const{left:n}=null==e||null==(t=e.target)?void 0:t.getBoundingClientRect(),{left:r}=s.element.getBoundingClientRect(),o=new PointerEvent("click",{bubbles:!0,cancelable:!0,clientX:e.clientX-(n-r),clientY:e.clientY});x.current.dispatchEvent(o)};return o().createElement("div",{key:r+"_field_"+e},o().createElement("span",{className:b()(N,{[H]:l}),style:l?Object.assign({},g.style,{"--top":g.location.top+"px","--left":g.location.left+"px","--width":E||g.location.width+"px","--height":R||g.location.height+"px","--font-size":g.style.fontSize,"--font-weight":g.style.fontWeight,"--padding":g.style.padding,"--text-align":g.style.textAlign,"--line-height":g.style.lineHeight}):{},onClick:e=>{e.stopPropagation()}},l&&o().createElement("style",{children:`#${u} .${A}${a?`[data-index="${e}"]`:""}{visibility: hidden;}`}),o().createElement(z,_({},O,"function"===typeof y?Object.assign({},y({isActive:l,blur:()=>v(null),formApi:p})):Object.assign({},y),{name:r,isActive:l}))),!l&&!g&&s&&o().createElement(m.Space,{key:r+"opt",className:L,style:{"--left":s.x+"px","--top":s.y+"px"}},k&&("function"===typeof S?S({onClick:c}):o().createElement(m.Button,{type:"text",icon:o().createElement(f.A,null),onClick:c})),C&&("function"===typeof j?j({onClick:c}):o().createElement(m.Button,{type:"text",icon:o().createElement(h.A,null),onClick:e=>{e.stopPropagation(),p.setField({name:r,value:null}),n((e=>{const t=e.slice(0);return t.push(r),t}))}}))))},F=i();return F?a?o().createElement(s.GroupList,{name:r,defaultLength:F.querySelectorAll(`.${A}`).length},(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const{index:r}=(e=>{if("object"===typeof e[0])return e[0];const[t,{index:n,onRemove:r,length:o}]=e;return{id:t,index:n,onRemove:r,length:o}})(t);return P(r)})):P(0):null})))},I=(0,r.forwardRef)(((e,t)=>{const n=Object.assign({},{width:"769px"},e),{data:i,template:l,options:s,isPreview:u,width:d}=n,[p,g]=(0,r.useState)(""),[m,f]=(0,r.useState)([]),h=(0,r.useRef)(null),v=(0,r.useRef)(null),b=(0,r.useRef)(null),y=(0,r.useCallback)((()=>h.current),[]),_=(0,r.useCallback)((()=>v.current),[]),w=(e=>{let{data:t}=e;return(0,r.useMemo)((()=>a()(t,((e,t,n)=>{e[n]=t.default}),{})),[t])})({data:i});(0,r.useEffect)((()=>{const e=Object.assign({},w),t=[];Object.keys(e).forEach((n=>{null===e[n]&&t.push(n)})),t.length>0&&f((e=>{const n=e.slice(0);return t.forEach((e=>{-1===n.indexOf(e)&&n.push(e)})),n}))}),[w]),(0,r.useImperativeHandle)(t,(()=>({getRenderHtml:()=>p,deleteFields:m,getFormData:()=>{var e;return b.current?null==(e=b.current)?void 0:e.data:{}}})));const R=(0,r.useId)().replace(/:/g,"_");return o().createElement(x,{value:{renderHtml:p,setRenderHtml:g,rootElementId:R,templateContent:l,initFormData:w,data:i,options:s,deleteFields:m,setDeleteFields:f,getRootElement:y,getRenderElement:_}},u?o().createElement(E,null):o().createElement("div",{id:R,className:z,ref:h,style:{width:d}},o().createElement(c(),{ref:b,data:w},o().createElement("div",{className:P,ref:v},o().createElement(E,null)),o().createElement(B,null))))}))},67823:(e,t,n)=>{const r=n(14888),o=n(27497),i=n(18710),l=e=>{if(r(e)){const t=o(e);return t.length>0&&t.some((e=>l(e)))}return i(e)?e.length>0&&e.some((e=>l(e))):"number"===typeof e?!isNaN(e):!(void 0===e||null===e||""===e||0===e.length)},a=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(i(e))return e.map((e=>a(e))).filter(l);if(r(e)){const t={};return Object.keys(e).forEach((n=>{const r=a(e[n]);l(r)&&(t[n]=r)})),t}return e};e.exports={isEmpty:e=>!l(e),isNotEmpty:l,filterEmpty:a}},17179:e=>{e.exports=function(e){return function(t){return null==e?void 0:e[t]}}},3677:(e,t,n)=>{var r=n(55949),o=Object.prototype,i=o.hasOwnProperty;e.exports=function(e,t,n,l){return void 0===e||r(e,o[n])&&!i.call(l,n)?t:e}},33856:(e,t,n)=>{var r=n(17179)({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});e.exports=r},82948:e=>{var t={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};e.exports=function(e){return"\\"+t[e]}},46256:e=>{e.exports=/<%-([\s\S]+?)%>/g},65568:e=>{e.exports=/<%([\s\S]+?)%>/g},48020:e=>{e.exports=/<%=([\s\S]+?)%>/g},83961:(e,t,n)=>{var r=n(47352),o=n(51480),i=n(67016),l=o((function(e,t,n,o){r(t,i(t),e,o)}));e.exports=l},32394:(e,t,n)=>{var r=n(88992),o=n(16521),i=n(95257),l=o((function(e,t){try{return r(e,void 0,t)}catch(n){return i(n)?n:new Error(n)}}));e.exports=l},21904:(e,t,n)=>{var r=n(33856),o=n(20907),i=/[&<>"']/g,l=RegExp(i.source);e.exports=function(e){return(e=o(e))&&l.test(e)?e.replace(i,r):e}},95257:(e,t,n)=>{var r=n(99635),o=n(76003),i=n(14888);e.exports=function(e){if(!o(e))return!1;var t=r(e);return"[object Error]"==t||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!i(e)}},54613:(e,t,n)=>{var r=n(83961),o=n(32394),i=n(86657),l=n(3677),a=n(82948),s=n(95257),c=n(54855),u=n(49723),d=n(48020),p=n(82092),g=n(20907),m=/\b__p \+= '';/g,f=/\b(__p \+=) '' \+/g,h=/(__e\(.*?\)|\b__t\)) \+\n'';/g,v=/[()=,{}\[\]\/\s]/,b=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,y=/($^)/,x=/['\n\r\u2028\u2029\\]/g,E=Object.prototype.hasOwnProperty;e.exports=function(e,t,n){var _=p.imports._.templateSettings||p;n&&c(e,t,n)&&(t=void 0),e=g(e),t=r({},t,_,l);var w,R,A=r({},t.imports,_.imports,l),C=u(A),j=i(A,C),k=0,S=t.interpolate||y,O="__p += '",z=RegExp((t.escape||y).source+"|"+S.source+"|"+(S===d?b:y).source+"|"+(t.evaluate||y).source+"|$","g"),P=E.call(t,"sourceURL")?"//# sourceURL="+(t.sourceURL+"").replace(/\s/g," ")+"\n":"";e.replace(z,(function(t,n,r,o,i,l){return r||(r=o),O+=e.slice(k,l).replace(x,a),n&&(w=!0,O+="' +\n__e("+n+") +\n'"),i&&(R=!0,O+="';\n"+i+";\n__p += '"),r&&(O+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),k=l+t.length,t})),O+="';\n";var F=E.call(t,"variable")&&t.variable;if(F){if(v.test(F))throw new Error("Invalid `variable` option passed into `_.template`")}else O="with (obj) {\n"+O+"\n}\n";O=(R?O.replace(m,""):O).replace(f,"$1").replace(h,"$1;"),O="function("+(F||"obj")+") {\n"+(F?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(w?", __e = _.escape":"")+(R?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+O+"return __p\n}";var N=o((function(){return Function(C,P+"return "+O).apply(void 0,j)}));if(N.source=O,s(N))throw N;return N}},82092:(e,t,n)=>{var r=n(21904),o={escape:n(46256),evaluate:n(65568),interpolate:n(48020),variable:"",imports:{_:{escape:r}}};e.exports=o}}]);
//# sourceMappingURL=830.7ae0e1a1.chunk.js.map